import{_ as le,a as ae,b as oe,c as ne,d as se,e as ie,f as re,g as ce,h as de,i as ue,j as _e,k as pe,l as ve,m as fe}from"./sjbizhi5-11a47ad2.js";import{d as ge,C as he,r as T,f as me,R as xe,i as Ne,L as Y,n as be,S as Z,j as S,c as N,b as d,m as A,q as j,l as $,A as F,v as C,G as V,H as O,x as I,p as Te,a as ye,o as f,I as Ce,k as D,_ as ke}from"./index-2560f5bc.js";import{v as we}from"./vueData-fd2fb5cd.js";const P={color:[{title:"黑色",value:"black"},{title:"白色",value:"white"},{title:"红色",value:"red"},{title:"蓝色",value:"blue"},{title:"黄色",value:"yellow"},{title:"绿色",value:"green"},{title:"紫色",value:"purple"},{title:"橙色",value:"orange"},{title:"青色",value:"cyan"}],textType:[{title:"标题",value:"h"},{title:"副标题",value:"h2"},{title:"正文",value:"normal"},{title:"加粗",value:"bold"},{title:"加细",value:"light"}],textShape:[{title:"斜体",value:"italic"},{title:"下划线",value:"underline"}]};function Se(l,u){if(!l)return u;let _="",y=u.lastIndexOf("-"),i=u.slice(0,y);return l.split(" ").forEach(g=>{g.indexOf(i)==-1&&(_+=" "+g)}),_+=" "+u,_.trim()}const G=function(){let l=document.createElement("span");function u(_){l.innerHTML=_;let y=[...l.children[0].classList].sort((i,g)=>i<g?-1:1);for(let i=1;i<l.children.length;i++)y.toString()==[...l.children[i].classList].sort((g,m)=>g<m?-1:1).toString()?(l.children[i-1].innerText=l.children[i-1].innerText+l.children[i].innerText,l.removeChild(l.children[i]),i--):y=[...l.children[i].classList].sort((g,m)=>g<m?-1:1);return l.innerHTML}return u}();function L(l,u,_){!l||!u||u==document.getElementById("vn-container")||l.nextSibling!=u&&(l.nextSibling?(l.parentNode.removeChild(l.nextSibling),L(l,u,_)):(l.parentNode==document.getElementById("vn-container")&&L(_,u.parentNode,_),L(l.parentNode,u,_)))}const je=l=>(Te("data-v-02bcbd6e"),l=l(),ye(),l),$e={class:"page_top"},Ve={class:"desc"},Oe={class:"vue-node"},Ie={class:"carousel-img"},Le=je(()=>d("span",null,"这是几张图片",-1)),Be={key:1,class:"node-show"},He=["contenteditable","innerHTML"],Me={class:"operate-color"},Re={class:"tag-area"},ze={class:"operate-color"},Ee={class:"tag-area"},Ae={class:"operate-textTpye"},De={class:"tag-area"},Pe={class:"operate-textShape"},Ue={class:"tag-area"},We=ge({__name:"Details",setup(l){const u=he();function _(e){return new URL(Object.assign({"../static/bg1.jpg":le,"../static/bgmohu.jpg":ae,"../static/bizhi4.jpg":oe,"../static/kedaya.jpeg":ne,"../static/picture1.webp":se,"../static/picture2.webp":ie,"../static/picture3.jpg":re,"../static/picture4.jpg":ce,"../static/picture5.jpg":de,"../static/picture6.jpg":ue,"../static/sjbizhi2.jpg":_e,"../static/sjbizhi3.jpg":pe,"../static/sjbizhi4.jpg":ve,"../static/sjbizhi5.jpg":fe})[`../static/${e}`],self.location).href}const y=[_("sjbizhi2.jpg"),_("sjbizhi3.jpg"),_("sjbizhi4.jpg"),_("sjbizhi5.jpg")];console.log(y);const i=T(void 0),g=new BroadcastChannel("details");g.onmessage=e=>{i.value=e.data,location.hash="#/details/"+e.data};const m=me(()=>we.filter(e=>e.id==i.value)[0]||{}),J=T(),U=T(),B=T(),H=T(),ee=T(),a=T({startNode:null,endNode:null,startTextNode:null,endTextNode:null,value:void 0,startOff:0,endOff:0}),k=T(!0);function K(){k.value=!k.value}function te(){const e=getSelection();a.value.value=e==null?void 0:e.toString(),a.value.startNode=e==null?void 0:e.anchorNode.parentNode,a.value.endNode=e==null?void 0:e.extentNode.parentNode,a.value.startTextNode=e==null?void 0:e.anchorNode,a.value.endTextNode=e==null?void 0:e.extentNode,a.value.startOff=e==null?void 0:e.anchorOffset,a.value.endOff=e==null?void 0:e.extentOffset,console.log("startTextNode.nodeValue",e==null?void 0:e.anchorNode.nodeValue),console.log("endTextNode.nodeValue",e==null?void 0:e.extentNode.nodeValue)}function M(e){let h=a.value.value;if(!h)return;let R=document.getElementById("vn-container");const z=a.value.startTextNode==a.value.endTextNode;if(console.log("inOneSpan",z),z){let t=a.value.startNode,s=a.value.startTextNode,c=s.nodeValue,w=Math.min(a.value.startOff,a.value.endOff),p=Math.max(a.value.startOff,a.value.endOff),n=c.slice(0,w),v=c.slice(p,c.length);if(t.nodeName.toUpperCase()!="SPAN"){console.log("文本标签");let r=document.createElement("span");r.className=e,r.innerText=h;let x=document.createTextNode(n),b=document.createTextNode(v);t.insertBefore(x,s),t.insertBefore(r,s),t.insertBefore(b,s),t.removeChild(s);return}else{console.log("span标签");let r=Se(t.className,e);n&&v?(console.log(1),c=`<span${t.className?` class="${t.className}"`:""}>${n}</span><span class="${r}">${h}</span><span${t.className?` class="${t.className}"`:""}>${v}</span>`):n&&!v?(console.log(2),console.log("afterStr",v),c=`<span${t.className?` class="${t.className}"`:""}>${n}</span><span class="${r}">${h}</span>`):!n&&v?(console.log(3),c=`<span class="${r}">${h}</span><span${t.className?` class="${t.className}"`:""}>${v}</span>`):(console.log(4),c=`<span class="${r}">${h}</span>`),t.innerHTML=G(c),(!n||!v)&&(t.parentNode.innerHTML=G(t.parentNode.innerHTML))}}else{let t=a.value.startNode,s=a.value.endNode,c=a.value.startOff,w=a.value.endOff,p=a.value.startTextNode,n=a.value.endTextNode;console.log("startTextNode.nodeValue",p.nodeValue),console.log("endTextNode.nodeValue",n.nodeValue);let v=p.nodeValue.slice(0,c),r=p.nodeValue.slice(c,p.nodeValue.length),x=n.nodeValue.slice(0,w),b=n.nodeValue.slice(w,n.nodeValue.length),o=document.createElement("span");o.className=e,o.innerText=h,h.replace(/\(/g,"_").replace(/\)/g,"-").search(r.replace(/\(/g,"_").replace(/\)/g,"-"))==0?(console.log("从前往后"),h!==r+x&&L(p,n,p),a.value.startTextNode.nodeValue=v,a.value.endTextNode.nodeValue=b,s.nodeName.toUpperCase()!="SPAN"?(console.log("前1"),s.insertBefore(o,n),!b&&s.removeChild(n)):(console.log("前2"),s.parentNode.insertBefore(o,s),!b&&s.parentNode.removeChild(s)),t.nodeName.toUpperCase()!="SPAN"?(console.log("前3"),!v&&t.removeChild(p)):(console.log("前4"),!v&&t.parentNode.removeChild(t))):(console.log("从后往前"),h!==r+x&&L(n,p,n),a.value.startTextNode.nodeValue=r,a.value.endTextNode.nodeValue=x,t.nodeName.toUpperCase()!="SPAN"?(console.log("后1"),t.insertBefore(o,p),!r&&t.removeChild(p)):(console.log("后2"),t.parentNode.insertBefore(o,t),!r&&t.parentNode.removeChild(t)),s.nodeName.toUpperCase()!="SPAN"?(console.log("后3"),!x&&s.removeChild(n)):(console.log("后4"),!x&&s.parentNode.removeChild(s))),R.innerHTML=G(R.innerHTML)}}let W,Q,X;function q(){if(k.value){if(!H._value)return;W=parseInt(window.getComputedStyle(J._value).width,10),Q=parseInt(window.getComputedStyle(H._value).width,10),X=parseInt(window.getComputedStyle(H._value).right,10),B._value.style.width=(Q+X)*.88+"px",U._value.style.right=parseInt(B._value.style.width,10)+W*.03+45+"px"}else B._value.style.width=0,U._value.style.right=W*.03+40+"px"}return xe(()=>{k.value,q()},{flush:"post"}),Ne(()=>{Y("detailsIsOpen","true"),i.value||(i.value=u.params.id)}),be(()=>{Z(q)()}),window.onresize=Z(q),window.onbeforeunload=()=>{Y("detailsIsOpen","false"),g.close()},(e,h)=>{var p,n,v,r,x,b;const R=S("el-image"),z=S("el-carousel-item"),t=S("el-carousel"),s=S("el-icon"),c=S("el-tag"),w=S("el-button");return f(),N("div",{ref_key:"containerRef",ref:J,class:"container"},[d("div",$e,[d("h1",null,A((p=m.value)==null?void 0:p.title),1),d("div",Ve,A((n=m.value)==null?void 0:n.desc),1)]),d("div",Oe,[d("div",Ie,[Le,j(t,{"indicator-position":"none"},{default:$(()=>[(f(),N(V,null,O(y,o=>j(z,{key:o},{default:$(()=>[j(R,{style:{width:"150px",height:"300px"},src:o,fit:"fill"},null,8,["src"])]),_:2},1024)),64))]),_:1})]),(v=m.value)!=null&&v.html?(f(),N("div",{key:0,ref_key:"editIcon",ref:U,class:"edit-show"},[j(s,{onClick:K},{default:$(()=>[j(I(Ce))]),_:1})],512)):F("",!0),(r=m.value)!=null&&r.html?(f(),N("div",Be,[d("div",{class:"node-text",ref_key:"vueNodeRef",ref:ee,contenteditable:k.value,innerHTML:(x=m.value)==null?void 0:x.html,onMouseup:te},null,40,He)])):F("",!0),d("div",{ref_key:"operatePlaceRef",ref:B,class:"node-operate_place"},null,512),k.value&&((b=m.value)!=null&&b.html)?(f(),N("div",{key:2,ref_key:"operateRef",ref:H,class:"node-operate"},[d("div",Me,[C(" 字体颜色: "),d("span",Re,[(f(!0),N(V,null,O(I(P).color,o=>(f(),D(c,{key:o.value,color:o.value,onClick:E=>M("vn-color-"+o.value)},null,8,["color","onClick"]))),128))])]),d("div",ze,[C(" 背景颜色: "),d("span",Ee,[(f(!0),N(V,null,O(I(P).color,o=>(f(),D(c,{key:o.value,color:o.value,onClick:E=>M("vn-background-color-"+o.value)},null,8,["color","onClick"]))),128))])]),d("div",Ae,[C(" 字体类型: "),d("span",De,[(f(!0),N(V,null,O(I(P).textType,o=>(f(),D(c,{key:o.value,onClick:E=>M("vn-text-type-"+o.value)},{default:$(()=>[C(A(o.title),1)]),_:2},1032,["onClick"]))),128))])]),d("div",Pe,[C(" 字体类型: "),d("span",Ue,[(f(!0),N(V,null,O(I(P).textShape,o=>(f(),D(c,{key:o.value,onClick:E=>M("vn-text-shape-"+o.value)},{default:$(()=>[C(A(o.title),1)]),_:2},1032,["onClick"]))),128))])]),j(w,{class:"edit-ok",type:"primary",size:"small",onClick:K},{default:$(()=>[C("完成编辑")]),_:1})],512)):F("",!0)])],512)}}});const Je=ke(We,[["__scopeId","data-v-02bcbd6e"]]);export{Je as default};
